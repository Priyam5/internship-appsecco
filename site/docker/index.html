


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.7">
    
    
      
        <title>Deploying SuiteCRM through Docker - DevSecOps</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.b8ac9624.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#implementing-suitecrm-through-docker" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="DevSecOps" class="md-header-nav__button md-logo" aria-label="DevSecOps">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            DevSecOps
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Deploying SuiteCRM through Docker
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DevSecOps" class="md-nav__button md-logo" aria-label="DevSecOps">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    DevSecOps
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contents/" title="Contents" class="md-nav__link">
      Contents
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../problem-statement/" title="Problem Statement" class="md-nav__link">
      Problem Statement
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Ubuntu-server-VM-setup/" title="Setup of VMs" class="md-nav__link">
      Setup of VMs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Jenkins-installation/" title="Setup of Jenkins" class="md-nav__link">
      Setup of Jenkins
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mkdocs-setup-usage/" title="MkDocs setup for report" class="md-nav__link">
      MkDocs setup for report
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../setting-up-pipeline/" title="Setting Up Pipeline" class="md-nav__link">
      Setting Up Pipeline
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../setting-up-suitecrm/" title="Set Up SuiteCRM" class="md-nav__link">
      Set Up SuiteCRM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../deployment-of-suitecrm/" title="Deployment of SuiteCRM" class="md-nav__link">
      Deployment of SuiteCRM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../sast-tools/" title="Static Analysis of SuiteCRM" class="md-nav__link">
      Static Analysis of SuiteCRM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../dast-tools/" title="Dynamic Analysis of SuiteCRM" class="md-nav__link">
      Dynamic Analysis of SuiteCRM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../sbom/" title="Software Bill of Materials" class="md-nav__link">
      Software Bill of Materials
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../linting-tool/" title="Source Code Analysis" class="md-nav__link">
      Source Code Analysis
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Deploying SuiteCRM through Docker
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Deploying SuiteCRM through Docker" class="md-nav__link md-nav__link--active">
      Deploying SuiteCRM through Docker
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    Dockerfile
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apache-installation" class="md-nav__link">
    Apache Installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suitecrm-installation" class="md-nav__link">
    SuiteCRM installation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dast-scan" class="md-nav__link">
    DAST scan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrating-into-pipeline" class="md-nav__link">
    Integrating into Pipeline
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../complete-pipeline-structure/" title="Complete Pipeline Structure" class="md-nav__link">
      Complete Pipeline Structure
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    Dockerfile
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apache-installation" class="md-nav__link">
    Apache Installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suitecrm-installation" class="md-nav__link">
    SuiteCRM installation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dast-scan" class="md-nav__link">
    DAST scan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrating-into-pipeline" class="md-nav__link">
    Integrating into Pipeline
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="implementing-suitecrm-through-docker">Implementing SuiteCRM through Docker</h1>
<h2 id="objective">Objective</h2>
<p>This section aims to implement the application SuiteCRM through Docker and deploy it through a pipeline. Solution to the first point of the <a href="https://intern-appsecco.netlify.app/problem-statement/">problem statement</a> under Task 2.</p>
<h2 id="docker">Docker</h2>
<p>An open-source project that automates the deployment of software applications inside containers by providing an additional layer of abstraction and automation of OS-level virtualization on Linux. In simple, Docker is a tool that allows developers, sys-admins, etc. to deploy applications in a sandbox (which in docker world we call it containers) to run over the host operating system. For Docker commands follow this <a href="https://github.com/wsargent/docker-cheat-sheet#dockerfile">link</a>. Before installation, let's talk about a little bit about container, image, and Dockerfile as we will come across these terms further:</p>
<ul>
<li>Container - A container is a running instance of an image.</li>
<li>Image - An image is a unit that contains everything ( the code, libraries, environments variables, and configuration files) that our service requires to run.</li>
<li>Dockerfile - Just assume it as a blueprint for creating Docker images, it can inherit from other containers, define what software to install and what commands to run.</li>
</ul>
<h2 id="dockerfile">Dockerfile</h2>
<p>Docker can build images automatically by reading the instructions from a Dockerfile. A Dockerfile is a text document that contains all the commands a user could call on the command line to assemble an image. Using <code>docker build</code> users can create an automated build that executes several command-line instructions in succession. For more details on Dockerfile, I refer this official link of <a href="https://docs.docker.com/engine/reference/builder/">docker</a></p>
<p>I started with building a dockerfile in which I implemented a PHP image because SuiteCRM is a PHP based application. I copied the image from dockerhub of <a href="https://hub.docker.com/_/php">php</a></p>
<h3 id="apache-installation">Apache Installation</h3>
<p>I begin with building the Dockerfile firstly with apache installation. </p>
<p>Note: got an error <code>unable to prepare context: unable to evaluate symlinks in Dockerfile path: lstat /home/jenkins-infra/docker-files/Dockerfile: no such file or directory</code>. Be careful while naming the Docker file name as <code>Dockerfile</code> other names don't work.</p>
<p>NOTE: I got an error my apache server was not getting served. I will explain in a little detail:</p>
<ul>
<li>I stopped my container <code>docker stop f9af4fb06f4c</code> and ran again <code>docker run -d --rm --name ubuntu2 -p 1234:80 4c0437bfcded</code>. After the container was build I checked If the port 1234 was open or not by <code>netstat -ntap</code> But there was no such network port 1234 open.</li>
<li>Then I checked the <code>docker logs ubuntu2</code> It showed <code>Error: No such container: ubuntu2</code> then I checked <code>docker ps -a</code> which showed the container exited in a minute.</li>
<li>After this I ran the above command of building container without the <code>-d flag</code> which is detached mode means running container in background then it gave the error <code>/bin/sh: 1: Syntax error: Unterminated quoted string</code>. From here I got to know I have missed a quote in my dockerfile in a command which I fixed.</li>
</ul>
<p>Dockerfile which finally worked is </p>
<pre><code># getting base image PHP

FROM php:7.4-cli

MAINTAINER Priyam Singh &lt;2020priyamsingh@gmail.com&gt;

# Executed during the building of the image
# Apache installation
RUN apt-get update
RUN apt-get install -y apache2

# Executed when container created out of image
CMD [&quot;apache2ctl&quot;,&quot;-D&quot;,&quot;FOREGROUND&quot;]
EXPOSE 80
</code></pre>

<h3 id="suitecrm-installation">SuiteCRM installation</h3>
<ul>
<li>Apache started running, but then I decided to use the image <code>php:7.4-apache</code> which have apache built-in and not to separately install it. </li>
<li>This is the Dockerfile I am using for now</li>
</ul>
<pre><code>#getting base image PHP

FROM php:7.4-apache

MAINTAINER Priyam Singh &lt;2020priyamsingh@gmail.com&gt;

# Executed during the building of the image
RUN apt-get update
RUN apt-get install -y libzip-dev zip unzip zlib1g-dev
RUN docker-php-ext-install mysqli zip

# Copying the SUiteCRM repositories
COPY dast-jenkins-pipeline /var/www/html/suitecrm
RUN chown -R www-data:www-data /var/www/html/suitecrm

# Executed when container created out of image
CMD [&quot;apache2ctl&quot;,&quot;-D&quot;,&quot;FOREGROUND&quot;]
EXPOSE 80
</code></pre>

<ul>
<li>I got this error on the SuiteCRM install.php page</li>
</ul>
<pre><code>Warning: require_once(modules/DynamicFields/DynamicField.php): failed to open stream: Permission denied in /var/www/html/suitecrm/data/SugarBean.php on line 45

Fatal error: require_once(): Failed opening required 'modules/DynamicFields/DynamicField.php' (include_path='.:/usr/local/lib/php') in /var/www/html/suitecrm/data/SugarBean.php on line 45
</code></pre>

<p>So I changed the permission of SuiteCRM directory within the running container</p>
<pre><code>chown -R www-data:www-data suitecrm
</code></pre>

<p>Changing permissions take too long so I mounted the directory of SuiteCRM.</p>
<ul>
<li>I installed zip because I got error Zip module not present in docker I added this command in Dockerfile</li>
</ul>
<pre><code>RUN apt-get install -y libzip-dev zip unzip zlib1g-dev
RUN docker-php-ext-install mysqli zip
</code></pre>

<ul>
<li>My database was not working so I firstly in <code>sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf</code> file binded the port 0.0.0.0 to allow all ports  and also allowed the ports 3306 the mysql port. Then I ran the below command to change the <code>suitecrm@localhost</code> to <code>suitecrm@%</code> so that it is accessible from anywhere.</li>
</ul>
<pre><code>sudo mysql -u root -p
UPDATE mysql.user SET Host='%' WHERE Host='localhost' AND User='suitecrm';
UPDATE mysql.db SET Host='%' WHERE Host='localhost' AND User='suitecrm';
FLUSH PRIVILEGES;
</code></pre>

<ul>
<li>I copied the config.php file after the installation of suitecrm done. To use scp to copy files to the remote server from your computer or copy files from the remote server to your computer, you must have the scp program available in both places (computer and remote server). This documentation will be <a href="https://linuxhint.com/linux_scp_command/">helpful</a></li>
</ul>
<p><code>scp -r config.php jenkins-infra@192.168.1.2:/home/jenkins-infra/docker-files</code></p>
<p>but it gave error <code>bash: scp: command not found</code> bec. openssh not installed in container 
<code>apt install -y openssh-client openssh-server</code> also install on client means we're saving the file the host/client <code>apt install -y openssh-client</code></p>
<h2 id="dast-scan">DAST scan</h2>
<p>On VM, run the dast scan similar to earlier as in the section <a href="https://intern-appsecco.netlify.app/dast-tools/">DevSecOps Dynamic Analysis of SuiteCRM</a>. Just do the changes in the command of URL same to where suitecrm is running inside the docker container</p>
<pre><code>docker run -i owasp/zap2docker-stable zap-baseline.py -t &quot;http://192.168.1.2:1234/suitecrm&quot; -l INFO
</code></pre>

<ul>
<li>An error I was facing of no space on the device so remove the images and stopped containers by using the commands</li>
</ul>
<pre><code>docker rmi &lt;image image name/ image id&gt;
docker rm &lt;docker name/docker id&gt;
</code></pre>

<h2 id="integrating-into-pipeline">Integrating into Pipeline</h2>
<p>For integrating on pipeline I followed these steps:</p>
<ul>
<li>Push the Dockerfile to the GitHub SuiteCRM repository which I forked <code>https://github.com/Priyam5/SuiteCRM.git/</code> in my GitHub. The Dockerfile is:</li>
</ul>
<pre><code>    FROM php:7.4-apache

    MAINTAINER Priyam Singh &lt;2020priyamsingh@gmail.com&gt;

    RUN apt-get update
    RUN apt-get install -y libzip-dev zip unzip zlib1g-dev
    RUN docker-php-ext-install mysqli zip

    EXPOSE 80
    ENTRYPOINT [&quot;/usr/sbin/apache2ctl&quot;, &quot;-D&quot;, &quot;FOREGROUND&quot;]
</code></pre>

<ul>
<li>In the pipeline add the step of <code>docker deployment</code> and in this stage, we will make an image from the Dockerfile and then container and also mount the directory. The stage is shown below</li>
</ul>
<pre><code>    stage ('docker deployment') {
                steps {
                    sh 'docker build -t dockerimage:latest .'
                    sh 'cp /var/lib/jenkins/workspace/config.php $(pwd)'
                    sh 'docker run -v $(pwd):/var/www/html/suitecrm -d --rm --name dockerzap3 -p 1233:80 dockerimage:latest'
                } 
            }    
</code></pre>

<ul>
<li>I was getting an apache error: <code>apache2: Syntax error on line 80 of /etc/apache2/apache2.conf: DefaultRuntimeDir must be a valid directory, absolute or relative to ServerRoot</code>. So in Dockerfile I added entrypoint as below:</li>
</ul>
<pre><code>    ENTRYPOINT [&quot;/usr/sbin/apache2ctl&quot;, &quot;-D&quot;, &quot;FOREGROUND&quot;]
</code></pre>

<ul>
<li>When I opened the URL http://192.168.1.2:1233/suitecrm/ the suitecrm was not getting deployed and I was getting warnings </li>
</ul>
<pre><code>    Warning: sugar_file_put_contents_atomic() : fatal rename failure '/tmp/tempPRdtfq' -&gt; 'cache/modules/Employees/Employeevardefs.php' in /var/www/html/suitecrm/include/utils/sugar_file_utils.php on line 204

    Warning: sugar_file_put_contents_atomic() : fatal rename failure '/tmp/tempZ0yMaj' -&gt; 'cache/modules/Users/Uservardefs.php' in /var/www/html/suitecrm/include/utils/sugar_file_utils.php on line 204

    Warning: sugar_file_put_contents_atomic() : fatal rename failure '/tmp/tempsEJ08b' -&gt; 'cache/modules/UserPreferences/UserPreferencevardefs.php' in /var/www/html/suitecrm/include/utils/sugar_file_utils.php on line 204

    Warning: sugar_file_put_contents_atomic() : fatal rename failure '/tmp/tempaF8Pd5' -&gt; 'cache/modules/Administration/Administrationvardefs.php' in /var/www/html/suitecrm/include/utils/sugar_file_utils.php on line 204

    Warning: session_start(): Cannot start session when headers already sent in /var/www/html/suitecrm/include/MVC/SugarApplication.php on line 619

    Warning: Cannot modify header information - headers already sent by (output started at /var/www/html/suitecrm/include/utils/sugar_file_utils.php:204) in /var/www/html/suitecrm/include/utils.php on line 3124

    Warning: session_destroy(): Trying to destroy uninitialized session in /var/www/html/suitecrm/include/MVC/SugarApplication.php on line 132
</code></pre>

<p>So it was coming because some directories of SuiteCRM were not having the appropriate permissions. For that I just ran this command and it started working:</p>
<pre><code>    sudo chmod -R 755 .

    sudo chmod -R 775 cache custom modules upload
</code></pre>

<ul>
<li>Now we will do the zap scan to the container made:</li>
</ul>
<pre><code>    stage ('OWASP ZAP') {
            steps {
                sh 'docker pull owasp/zap2docker-stable'
                sh 'docker run --network=host -v $(pwd)/zap-report:/zap/wrk/ -i owasp/zap2docker-stable zap-baseline.py -t http://192.168.1.2:1233/suitecrm/ -I -r zap_baseline_report.html -l PASS'
                sh 'docker rm -f dockerzap3'

</code></pre>

<ul>
<li>
<p>I got error <code>I/O error(5): ZAP failed to access: http://192.168.1.2:1233/suitecrm/</code> because zap container was not able to scan the provided URL due to which I added the flag <code>--network=host</code> and it worked because normally we have to forward ports from the host machine into a container, but when the containers share the host's network, any network activity happens directly on the host machine - just as it would if the program was running locally on the host instead of inside a container.</p>
</li>
<li>
<p>I also got the error SuiteCRM was not able to print the report <code>/zap/wrk/zap_baseline_report.html</code>. So I gave to the directory zap-report permissions:</p>
</li>
</ul>
<pre><code>    sudo chown -R jenkins:jenkins zap-report
    sudo chmod 777 zap-report 
</code></pre>

<ul>
<li>Here is the report which got generated after the <a href="https://github.com/Priyam5/internship-appsecco/blob/master/Reports/docker_zap_baseline_report.html">zap scan</a> worked successfully.</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../linting-tool/" title="Source Code Analysis" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Source Code Analysis
              </div>
            </div>
          </a>
        
        
          <a href="../complete-pipeline-structure/" title="Complete Pipeline Structure" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Complete Pipeline Structure
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.d1f5a259.min.js"></script>
      <script src="../assets/javascripts/bundle.d5fec882.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.fae956e7.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>